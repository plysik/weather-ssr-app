(()=>{"use strict";var e={12:e=>{e.exports=require("react-router-dom/server")},15:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(732),o=n(r(252)),a=n(r(928)),i=r(468),u=r(12),c=r(544),l=r(257),d=n(r(834)),p=r(110),h=n(r(818)),f=r(367);h.default.config();const _=(0,o.default)();_.use(o.default.static(a.default.resolve(__dirname,"../dist/assets"))),_.get("/api/weather",async(e,t)=>{const r=e.query.city;if(!r)return t.status(400).json({error:"Brak parametru city"});try{const e=await(0,p.fetchWeather)(r);t.json(e)}catch{t.status(500).json({error:"Błąd pobierania pogody"})}}),_.get("/:city",async(e,t)=>{const r=e.params.city;if(!r)return t.sendStatus(404);const n=(0,l.createStore)();try{const e=await(0,p.fetchWeather)(r);n.dispatch({type:"weather/setCurrent",payload:e})}catch{n.dispatch({type:"weather/setCurrent",payload:{city:r,temperature:20,humidity:60,wind:10,fallback:!0}})}const o=(0,i.renderToString)((0,s.jsx)(c.Provider,{store:n,children:(0,s.jsx)(u.StaticRouter,{location:e.url,children:(0,s.jsx)(d.default,{})})})),a=(0,f.renderFullPage)(o,`Pogoda dla ${r}`,n.getState());t.send(a)}),_.get("/",(e,t)=>{const r=(0,l.createStore)(),n=(0,i.renderToString)((0,s.jsx)(c.Provider,{store:r,children:(0,s.jsx)(u.StaticRouter,{location:e.url,children:(0,s.jsx)(d.default,{})})})),o=(0,f.renderFullPage)(n,"Prognoza pogody",r.getState());t.send(o)}),_.listen(3e3,()=>{console.log("Serwer działa na http://localhost:3000")})},72:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchWeather=async function(e){const t=await fetch(`/api/weather?city=${encodeURIComponent(e)}`);if(!t.ok)throw new Error(`Błąd pobierania pogody: ${t.status}`);return await t.json()}},110:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchWeather=async function(e){if(console.log("🔑 WEATHER_API_KEY:",o?.slice(0,5),"..."),!o)throw new Error("❌ WEATHER_API_KEY is missing in .env!");const t=`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(e)}&units=metric&appid=${o}&lang=pl`,r=await(0,s.default)(t);if(!r.ok)throw new Error(`🌩 Weather fetch failed: ${r.status} ${r.statusText}`);const n=await r.json();return{name:n.name,temp:n.main.temp,feels_like:n.main.feels_like,humidity:n.main.humidity,pressure:n.main.pressure,wind_speed:n.wind.speed,wind_deg:n.wind.deg,description:n.weather[0].description,icon:n.weather[0]?.icon}};const s=n(r(229));n(r(818)).default.config();const o=process.env.WEATHER_API_KEY},124:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{city:e=""}=(0,a.useParams)();console.log("[CITYPAGE MOUNT]",e);const t=(0,i.useDispatch)(),r=(0,i.useSelector)(e=>e.weather.current);return console.log("[SELECTOR] Weather:",r),(0,o.useEffect)(()=>{r&&r.name?.toLowerCase()===e?.toLowerCase()||(0,c.fetchWeather)(e).then(e=>t((0,u.setCurrent)(e))).catch(e=>console.error(e))},[e]),r&&r.name.toLowerCase()===e?.toLowerCase()?(0,s.jsxs)("main",{children:[(0,s.jsx)(l.default,{}),(0,s.jsxs)("section",{children:[(0,s.jsxs)("h1",{children:["Pogoda w ",r.name]}),(0,s.jsx)("p",{style:{textTransform:"capitalize"},children:r.description}),(0,s.jsx)("img",{src:`https://openweathermap.org/img/wn/${r.icon}@2x.png`,alt:r.description}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:["🌡 Temperatura: ",r.temp," °C"]}),(0,s.jsxs)("li",{children:["🥵 Odczuwalna: ",r.feels_like," °C"]}),(0,s.jsxs)("li",{children:["💧 Wilgotność: ",r.humidity,"%"]}),(0,s.jsxs)("li",{children:["🔽 Ciśnienie: ",r.pressure," hPa"]}),(0,s.jsxs)("li",{children:["💨 Wiatr: ",r.wind_speed," m/s (",(n=r.wind_deg,["N","NE","E","SE","S","SW","W","NW"][Math.round(n/45)%8]),")"]})]})]})]}):(0,s.jsxs)("main",{children:[(0,s.jsx)(l.default,{}),(0,s.jsx)("p",{children:"Ładowanie danych pogodowych..."})]});var n};const s=r(732),o=r(396),a=r(822),i=r(544),u=r(707),c=r(72),l=n(r(782))},229:e=>{e.exports=require("node-fetch")},252:e=>{e.exports=require("express")},257:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createStore=void 0;const s=r(740),o=n(r(707)),a=(0,s.combineReducers)({weather:o.default});t.createStore=e=>(0,s.configureStore)({reducer:a,preloadedState:e})},280:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(732),o=n(r(782));t.default=()=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Weather App"}),(0,s.jsx)(o.default,{})]})},367:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderFullPage=function(e,t,r){const n=o.default.resolve(__dirname,"./template.html"),a=s.default.readFileSync(n,"utf8"),i=`<script>window.__PRELOADED_STATE__ = ${JSON.stringify(r).replace(/</g,"\\u003c")}<\/script>`;return a.replace("\x3c!--TITLE--\x3e",t).replace("\x3c!--APP--\x3e",e).replace("\x3c!--STATE--\x3e",i).replace("</body>",'<script type="module" src="/assets/index.js"><\/script></body>')};const s=n(r(896)),o=n(r(928))},396:e=>{e.exports=require("react")},468:e=>{e.exports=require("react-dom/server")},544:e=>{e.exports=require("react-redux")},707:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.selectCurrentWeather=t.clearCurrent=t.setCurrent=void 0;const s=(0,r(740).createSlice)({name:"weather",initialState:{current:null},reducers:{setCurrent:(e,t)=>(console.log("[REDUCER] setCurrent:",t.payload),{...e,current:t.payload}),clearCurrent:e=>({...e,current:null})}});n=s.actions,t.setCurrent=n.setCurrent,t.clearCurrent=n.clearCurrent,t.selectCurrentWeather=e=>e.weather.current,t.default=s.reducer},732:e=>{e.exports=require("react/jsx-runtime")},740:e=>{e.exports=require("@reduxjs/toolkit")},782:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(732),s=r(822),o=r(396);t.default=()=>{const[e,t]=(0,o.useState)(""),r=(0,s.useNavigate)();return(0,n.jsxs)("form",{onSubmit:t=>{t.preventDefault();const n=e.trim();n&&r(`/${encodeURIComponent(n)}`)},children:[(0,n.jsx)("input",{type:"text",placeholder:"Wpisz miasto",value:e,onChange:e=>t(e.target.value)}),(0,n.jsx)("button",{type:"submit",children:"Szukaj"})]})}},818:e=>{e.exports=require("dotenv")},822:e=>{e.exports=require("react-router-dom")},834:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(732),o=r(822),a=n(r(280)),i=n(r(124));t.default=()=>{const e=(0,o.useLocation)();return(0,s.jsxs)(o.Routes,{children:[(0,s.jsx)(o.Route,{path:"/:city",element:(0,s.jsx)(i.default,{},e.pathname)}),(0,s.jsx)(o.Route,{path:"/",element:(0,s.jsx)(a.default,{})})]})}},896:e=>{e.exports=require("fs")},928:e=>{e.exports=require("path")}},t={};!function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(15)})();